resources:
  jobs:
    initial_setup_job:
      name: dbx_gwb_initial_setup

      email_notifications:
        on_failure:
          - ${var.current_user}

      tasks:
        - task_key: create_table_task
          notebook_task:
            notebook_path: ../../notebooks/initialize_tables.py
          max_retries: 0 

        # - task_key: create_non_dab_resources
        #   notebook_task:
        #     notebook_path: ../../notebooks/create_non_dab_resources.py
        #   depends_on:
        #     - task_key: create_table_task

      environments:
        - environment_key: Default
          spec:
            client: '1'
            dependencies:
              - ../../library/genesis_workbench/dist/*.whl
              - databricks-sdk==0.50.0

      parameters:
        - name: catalog
          default: ${var.core_catalog_name}
        - name: schema
          #default: ${resources.schemas.core_workbench.name}
          default: ${var.core_schema_name}

      tags: ${var.common_resource_tags}
