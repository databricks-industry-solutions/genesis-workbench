resources:
  jobs:
    permissions_setup:
      name: "Genesis Workbench Permissions Setup - ${bundle.target}"
      tasks:
        - task_key: "setup_permissions"
          description: "Set up app permissions for Genesis Workbench"
          notebook_task:
            notebook_path: "../../library/genesis_workbench/src/genesis_workbench/privilege_management/setup_permissions_notebook.py"
            base_parameters:
              catalog_name: "${var.core_catalog_name}"
              schema_name: "${var.core_schema_name}"
              initial_admin_user: "${var.admin_user}"
              environment: "${bundle.target}"
          timeout_seconds: 3600

      environments:
        - environment_key: Default
          spec:
            client: '1'

      parameters:
        - name: catalog_name
          default: ${var.core_catalog_name}
        - name: schema_name
          default: ${var.core_schema_name}
        - name: initial_admin_user
          default: ${var.admin_user}
        - name: environment
          default: ${bundle.target}

      tags: ${var.common_resource_tags}
