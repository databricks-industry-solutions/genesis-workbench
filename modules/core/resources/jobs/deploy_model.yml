resources:
  jobs:
    deploy_model_job:
      name: dbx_gwb_deploy_model_job

      email_notifications:
        on_failure:
          - ${var.current_user}

      tasks:
        - task_key: deploy_model_task
          notebook_task:
            notebook_path: ../../notebooks/deploy_model.py
          max_retries: 0 

      environments:
        - environment_key: default
          spec:
            client: '2'

      max_concurrent_runs: 5

      parameters:
        - name: catalog
          default: ${var.core_catalog_name}
        - name: schema
          default: ${var.core_schema_name}
        - name: sql_warehouse_id
          default: ${var.sql_warehouse_id}          
        - name: gwb_model_id
          default: '-1' 
        - name: dev_user_prefix
          default: ${var.dev_user_prefix}          
        - name: deployment_name
          default: name
        - name: deployment_description
          default: description
        - name: workload_type
          default: "GPU_SMALL"
        - name: workload_size
          default: Small
        - name: deploy_user
          default: none
        - name: databricks_app_name
          default: ${var.app_name}
      
      tags: ${var.common_resource_tags}

